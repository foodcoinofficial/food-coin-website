<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="300"> 
    <title>Food Coin Top Holders</title>
    <style>
        :root {
            --primary-color: #00FFA3;
            --background-color: #111119;
            --surface-color: #1A1A24;
            --text-color: #FFFFFF;
            --text-muted: #8899A9;
            --border-color: #2A2A38;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--background-color); color: var(--text-color); margin: 0; padding: 20px; }
        h3 { font-weight: 700; font-size: 1.8em; text-align: center; margin-bottom: 20px; color: var(--primary-color); }
        ol { list-style-type: none; padding: 0; margin: 0; }
        li { background-color: var(--surface-color); border: 1px solid var(--border-color); border-radius: 6px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; font-size: 1.1em; font-family: monospace; opacity: 0; animation: fadeIn 0.5s forwards; }
        .rank { font-weight: 700; color: var(--primary-color); margin-right: 15px; }
        .address { flex-grow: 1; }
        .percentage { color: var(--text-muted); font-weight: 700; }
        @keyframes fadeIn { to { opacity: 1; } }
    </style>
</head>
<body>
    <h3>Top $FC Holders</h3>
    <ol id="holders-list">
        <li>Loading...</li>
    </ol>

    <script>
        // --- CONFIGURATION ---
        // After launch, paste your token's main address here
        const TOKEN_MINT_ADDRESS = '4CBToKTRKfBsv8RMfzMr6VfKQ8PLRYeG6RFGZmq4pump';
        // --------------------

        async function fetchTopHolders() {
            const list = document.getElementById('holders-list');
            
            if (TOKEN_MINT_ADDRESS === 'YOUR_TOKEN_MINT_ADDRESS_HERE') {
                list.innerHTML = '<li>Please configure the token mint address.</li>';
                return;
            }

            try {
                // This calls our new Vercel API endpoint
                const response = await fetch(`/api/get-holders?mint=${TOKEN_MINT_ADDRESS}`);
                const holders = await response.json();

                if (!response.ok) {
                    throw new Error(holders.error || 'Failed to fetch data');
                }

                // Clear the 'Loading...' message
                list.innerHTML = ''; 

                // Create and add the list items for each holder
                holders.forEach((holder, index) => {
                    const li = document.createElement('li');
                    li.style.animationDelay = `${index * 100}ms`; // Staggered fade-in effect
                    li.innerHTML = `
                        <span class="rank">#${holder.rank}</span>
                        <span class="address">${holder.address}</span>
                        <span class="percentage">${holder.percentage}</span>
                    `;
                    list.appendChild(li);
                });

            } catch (error) {
                console.error('Error fetching top holders:', error);
                list.innerHTML = `<li>Error loading data.</li>`;
            }
        }
        
        // Fetch the data when the page loads
        fetchTopHolders();
    </script>
</body>
</html>